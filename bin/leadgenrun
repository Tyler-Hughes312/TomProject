#!/bin/bash

# Lead Generator Development Server
# Based on LegislationForDumbies pattern

set -Eeuo pipefail

echo "ğŸš€ Starting Lead Generator..."

# Activate virtual environment
source env/bin/activate

# Set up trap to kill background processes on exit
trap "trap - SIGTERM && kill -- -$$" SIGINT SIGTERM EXIT

# Start webpack in watch mode in the background
echo "ğŸ”¨ Starting webpack in watch mode..."
npx webpack --watch &

# Start Flask development server
echo "ğŸŒ Starting Flask development server..."
python -m leadgen

echo "âœ… Lead Generator is running!"
echo "ğŸŒ Main App: http://localhost:5000/"
echo "ğŸ” API Health: http://localhost:5000/api/v1/"
echo ""
echo "Press Ctrl+C to stop the server"